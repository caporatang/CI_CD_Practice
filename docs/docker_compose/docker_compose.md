## docker compose?
- docker compose는 kubernetes와 같이 컨테이너 오케스트레이션 및 컨테이너화된 애플리케이션 관리에 사용되는 도구다.
- docker compose는 다중 컨테이너 Docker 애플리케이션을 정의하고 실행하기 위한 도구이고, YAML 파일을 사용하여 애플리케이션 서비스를 수행한다.
- 이후 docker COMPOSE CLI를 이용하여 모든 서비스의 라이프 사이클을 관리한다.

## docker compose
- 응집력 있는 애플리케이션(cohesive application)으로 함께 작동하는 여러 컨테이너를 실행하려는 로컬 개발 및 테스트 환경을 위해 설계된 도구다.
- docker compose YAML 코드는 여러 개의 docker run 실행화 유사하며 네트워크, 볼륨 등을 한번에 생성할 수 있다.
> - 기본 이미지, 노출된 포트, 환경 변수 컨테이너 간의 종속성 등을 포함하는 컨테이너들에 대한 구성 지정
> - docker compose로 실행된 컨테이너들은 독립된 네트워크로 구성되므로 컨테이너 간 통신이 쉽다.
- docker compose 3단계 프로세스
> 1. Dockerfile 작성으로 배포하고자 하는 애플리케이션 환경 정의 (선택)
> 2. docker-compose.yaml (or compose.yaml) 하나 이상의 컨테이너 서비스를 실행할 수 있도록 정의
> 3. dcoker compose up 명령으로 YAML 코드로 정의된 서비스를 시작하고 실행한다.

### compose 장점과 단점
- 장점
> 1. 서로 다른 OS 환경이라도 동일한 환경 구성이 가능하다. (이식성)
> 2. 동일한 환경을 사용하기 때문에 개발환경에 이슈가 발생해도 팀간 소통이 쉽다.
> 3. 복잡한 환경도 YAML 코드로 스크립트화 할 수 있기 때문에 자동화가 가능하다.
> 4. docker compose CLI를 이용하여 쉽게 "멀티 컨테이너 애플리케이션"을 관리할 수 있다.
- 단점 
> 1. 동시에 다수의 컨테이너 서비스를 수행하는 경우(MSA) 자원 활용률이 순간 높아질 수 있다.
> 2. docker compose 사용은 충분한 docker container 기술에 대한 이해도가 필요하다.

### 선언적 구성, docker compose vs Kubernetes
| 비교              | docker compse                                     | kubernetes                                              | 
|-----------------|---------------------------------------------------|---------------------------------------------------------|
| 사용 범위           | 단일 호스트(로컬)에서의 개발, 테스트 및 소규모 배포에 적합                | 클러스터로 구성된 전체 머신을 기반으로 컨테이너화된 애플리케이션 배포에 적합              |
| 구조              | 단일 시스템에서 컨테이너 간의 실행, 상호 작용 및 종속성 관리               | 클러스터의 여러 노드에서 컨테이너를 오케스트레이션하고 확장, 로드밸런싱 메커니즘 제공         |
| 확장성 및 고가용성      | 여러 호스트 서비스 지원하지 않음. 단, docker swarm 클러스테어스는 지원    | 수요에 따른 애플리케이션 자동 확장 및 분산, 컨테이너 재시작 및 자동 장애 처리 기능 제공     |
| 서비스 검색 및 로드밸런싱  | 자체 네트워크 생성. 컨테이너 연결 지원 및 서비스 간 포트 노출. 자체 로드밸런싱 없음 | DNS 기반 서비스 검색과 다중 컨테이너 간 분산 처리하는 로드밸런싱 제공               |
| 롤링 업데이트 및 배포 전략 | 수동적 롤링 업데이트만 지원                                   | 다운 타임 없이 컨테이너 업데이트 가능. Blue/green 및 카나리아 배포 같은 배포 전략 제공 |

## YAML ?
- Yet Another Markup Language or YAML ain't markup language(Text file)
- 사람이 쉽게 읽을 수 있는 데이터 직렬화 언어 (위 -> 아래)로 구성 파일 작성에 주로 사용 된다.
> - 일반적으로 설계 상 가장 먼저 실행되야 하는 애플리케이션을 먼저 작성하고, 이와 의존성을 갖는 데이터베이스 및 하위 애플리케이션을 작성한다.
> - 또는, 클러스터 환경인 경우 마스터 노드를 먼저 작성하고 그 다음 데이터 노드들을 이어서 작성하면 된다.
> - 그 다음 전체 애플리케이션에 필요한 네트워크, 볼륨, 캐시 등의 기반 환경까지 코드에 모두 설정할 수 있다.
>  - 따라서, 서비스 전체를 하나의 docker-compose.yaml 로 작성이 가능하다.
- 쉽게 읽고 이해할 수 있도록 설계되어 프로그래밍 언어로 사용 되거나, 클라우드 자동 환경 배포 도구(IaC 환경 구성)로 많이 사용된다.
> - AWS CloudFormation, Redhat Ansible 등..

- 문법적 특징
> | YAML                       | JSON                      |
> |----------------------------|---------------------------|
> | YAML Ain't Markup Language | JavaScript Object Notation |
> | 주석 사용 가능                   | 주석 사용 불가                  |
> | 한글 등의 유니코드를 그대로 사용 가능      | 한글 등의 멀티 바이트 문자는 인코딩 수행   |
> | 주로 환경 구성 등의 설정 파일 작성 시 사용  | 주로 API 작성 시 사용    |
- 중괄호, 대괄호, 닫기 태그 또는 따옴표와 같은 통상적인 형식 기호는 없다.
- Python 스타일의 들여쓰기를 사용해 구조를 결정하고 중첩을 표시한다.
- 시스템 전반에서 이식성을 유지하기 위해 들여쓰기는 탭(tab)을 허용하지 않고, 그대로의 공백 문자를 원하는 공백*n으로 규칙성 있게 사용한다.
- YAML 코드는 key, value 중심으로 작성되고, 숫자형, 문자형, Boolean형을 지원한다.
> - #(샾) : 해당 라인 주석처리
> - --- : 문서의 시작 (선택)
> - ... : 문서의 끝 (선택)
> - key:python dictionary 자료형의  key와 동일
> - value:python dictionary 자료형의 value와 동일
- 계층 구조는 부모-자식 간의 레벨을 규칙성 있는 들여쓰기로 엄격하게 구분해야 한다.

